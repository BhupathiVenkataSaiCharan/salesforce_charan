<template>
    <lightning-card title="Add Products in Opportunity">
        <lightning-button label="Add Products" variant="brand" onclick={showAddProducts}></lightning-button>

        <template if:true={showAdd}>
            <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01" class="slds-modal slds-fade-in-open slds-modal_medium">
                <div class="slds-modal__container">
                    <lightning-button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" icon-name="utility:close" onclick={closeModal}></lightning-button>
                    <div class="slds-modal__header">
                        <h1 id="modal-heading-01" class="slds-modal__title slds-hyphenate" tabindex="-1">Add Products</h1>
                    </div>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <lightning-datatable key-field="Id" data={data} columns={columns} onrowselection={handleRowSelection}></lightning-datatable>
                    </div>
                    <div class="slds-modal__footer">
                        <lightning-button class="slds-button" label="Cancel" variant="outline" onclick={closeModal}></lightning-button>
                        <lightning-button class="slds-button" label="Save" variant="brand" onclick={goToEditProducts}></lightning-button>
                    </div>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>
        </template>

        <template if:true={showEdit}>
            <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-02" class="slds-modal slds-fade-in-open slds-modal_medium">
                <div class="slds-modal__container">
                    <lightning-button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" icon-name="utility:close" onclick={closeModal}></lightning-button>
                    <div class="slds-modal__header">
                        <h1 id="modal-heading-02" class="slds-modal__title slds-hyphenate" tabindex="-1">Edit Products List</h1>
                    </div>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-2">
                        <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                            <thead>
                                <tr>
                                    <th scope="col">
                                        <div class="slds-truncate" title="Product Name">Product Name</div>
                                    </th>
                                    <th scope="col">
                                        <div class="slds-truncate" title="Product Code">Product Code</div>
                                    </th>
                                    <th scope="col">
                                        <div class="slds-truncate" title="Unit Price">Unit Price</div>
                                    </th>
                                    <th scope="col">
                                        <div class="slds-truncate" title="Quantity">Quantity</div>
                                    </th>
                                    <th scope="col">
                                        <div class="slds-truncate" title="Total Price">Total Price</div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={editList} for:item="product">
                                    <tr key={product.Id}>
                                        <td>
                                            <div class="slds-truncate" title={product.Name}>{product.Name}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate" title={product.ProductCode}>{product.ProductCode}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate" title={product.UnitPrice}>{product.UnitPrice}</div>
                                        </td>
                                        <td>
                                            <lightning-input type="number" value={product.Quantity} data-id={product.Id} onchange={handleQuantityChange} min="1"></lightning-input>
                                        </td>
                                        <td>
                                            <div class="slds-truncate" title={product.TotalPrice}>{product.TotalPrice}</div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                    <div class="slds-modal__footer">
                        <lightning-button class="slds-button" label="Back" variant="outline" onclick={goToAddProducts}></lightning-button>
                        <lightning-button class="slds-button" label="Cancel" variant="outline" onclick={closeModal}></lightning-button>
                        <lightning-button class="slds-button" label="Save" variant="brand" onclick={saveProductsList}></lightning-button>
                    </div>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>
        </template>
    </lightning-card>
</template>











<!-- <template>

    <template if:true={showAdd}>
        <lightning-modal-header label="Add Products"></lightning-modal-header>
        <lightning-modal-body>
            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                <lightning-datatable key-field="Id" data={data} columns={columns}
                                       onrowselection={handleRowSelection}
                ></lightning-datatable>
           </div>
        </lightning-modal-body>
        <lightning-modal-footer>
            <lightning-button label="Cancel" onclick={closeModal}></lightning-button>
            <lightning-button label="Save" onclick={goToEditProducts}></lightning-button>
        </lightning-modal-footer>
    </template>

    <template if:true={showEdit}>
        <lightning-modal-header label="Edit Selected Products"></lightning-modal-header>
    <lightning-modal-body>
            selectRows
    </lightning-modal-body>
    <lightning-modal-footer>
        <lightning-button label="Back" onclick={goToAddProducts}></lightning-button>
        <lightning-button label="Cancel" onclick={closeModal}></lightning-button>
        <lightning-button label="Save" onclick={saveSelectedProducts}></lightning-button>
    </lightning-modal-footer>
    </template>
</template> -->